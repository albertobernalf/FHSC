SELECT '860007373' AS NIT, '1' AS COD_SUCURSAL,  CASE REG.MTUDES WHEN 'CONTRIBUTIVO' THEN 'POSC'END AS REGIMEN , FAC.MPNFAC AS FACTURA , FAC.FACFCH AS FCH_FACTURA, FAC.MATOTF AS VLR_TOTAL, FAC.MAVaAb AS VLR_COPAGO , '0' AS  VLR_MODERADORA , FAC.MAVDsc AS VLR_DESCUENTOS , FAC.MaVlrTIv AS VLR_IVA, 'NO' AS MULTIUSUARIOS , PAC.MPTDOC AS TPDOCUMENTO, PAC.MPCEDU AS DOCUMENTO,  PAC.MPAPE1 AS  PRIAPELLIDO, PAC.MPAPE2 AS SEGAPELLIDO , PAC.MPNOM1 AS PRINOMBRE , PAC.MPNOM2 AS SEGNOMBRE , DATE (PAC.MPFCHN) AS FCHNACIMIENTO , PAC.MPSEXO AS GENERO , DATE (ING.INGFECADM) AS FCH_INGRESO , DATE (ING.INGFECEGR) AS FCH_EGRESO , DATE(FCTPR.MAFePr) AS FCH_PREST_SERVICIO , FAC.MADI1I AS DIAGNOSTICOS1 , FAC.MADI2I AS DIAGNOSTICOS2 , FAC.MADI3I AS DIAGNOSTICOS3, FAC.MATOTF AS VLR_TOTAL_USU , FAC.MAVaAb AS VLR_COPAGO_USU,  '0'  AS VLR_MODERADORA_USU , FAC.MAVDsc AS VLR_DESCUENTOS_USU, FAC.MaVlrTIv AS VLR_IVA_USU ,CASE  WHEN  LENGTH(REPLACE ((TRIM(TRANSLATE(FAC.MPNUMA , ' ', ' ABCDEFGHIJKLMNOPQRSTUVWXYZ@-/()#*.') )) ,' ', '') ) > 0 THEN   REPLACE ((TRIM(TRANSLATE(MPNUMA , ' ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ@*-/()#.') )) ,' ', '')  ELSE   '0' END AS NRO_AUTORIZACION ,  FCTPR.PRCODI AS COD_SERVICIO , TRANSLATE(PROC.PRNOMB , ' ' , '",' ) AS DES_SERVICIO,  FCTPR.MACANPR AS CANTIDAD , FCTPR.MAVLRTOT AS VLR_UNITARIO_SERV,  FCTPR.MAVLRTOT AS VLR_TOTAL_SERV , '0' AS VLR_COPAGO_SERV , '0' AS VLR_MODERADORA_SRV ,  '0' AS VLR_DESCUENTOS_SERV , '0'  AS VLR_IVA_SERV 
FROM HOSVITAL.MAEATE AS FAC
LEFT JOIN HOSVITAL.CAPBAS AS PAC ON PAC.MPCEDU = FAC.MPCEDU AND PAC.MPTDOC = FAC.MPTDOC 
LEFT JOIN HOSVITAL.INGRESOS AS ING ON ING.MPCEDU = FAC.MPCEDU AND ING.INGCSC = FAC.MACTVING AND ING.MPTDOC = FAC.MPTDOC
LEFT JOIN HOSVITAL.MAEPAC AS CNTR ON CNTR.MPCEDU= FAC.MPCEDU AND CNTR.MPTDOC = FAC.MPTDOC AND CNTR.MENNIT = FAC.MPMENI
LEFT JOIN HOSVITAL.MAETPA2 AS REG   ON CNTR.MTUCOD = REG.MTUCOD
LEFT JOIN HOSVITAL.MAEATE2 AS FCTPR ON (FCTPR.MPNFAC = FAC.MPNFAC AND FCTPR.MAHONCOD <>'' AND FCTPR.MPNGRP<> '' AND   FCTPR.MAAGRCIR <> 0)
LEFT JOIN HOSVITAL.MAEPRO AS PROC ON PROC.PRCODI =  FCTPR.PRCODI
LEFT JOIN HOSVITAL.ADMGLO11 AS REM ON REM.MPNFAC  = FAC.MPNFAC
WHERE  FCTPR.FCPTPOTRN <> 'H' AND FCTPR.MAESANUP <> 'S' AND FAC.MPMENI IN ('NUEVAEPS', 'CS0111', 'SS0110', 'QUIRURGUICO') AND REM.AGLREMNR  BETWEEN 22754 AND  22821 
GROUP BY  REG.MTUDES  , FAC.MPNFAC  , FAC.FACFCH , FAC.MATOTF , FAC.MAVaAb  , FAC.MAVDsc  , FAC.MaVlrTIv ,  PAC.MPTDOC , PAC.MPCEDU ,  PAC.MPAPE1 , PAC.MPAPE2  , PAC.MPNOM1  , PAC.MPNOM2  , DATE (PAC.MPFCHN)  , PAC.MPSEXO  , DATE (ING.INGFECADM)  , DATE (ING.INGFECEGR)  , DATE(FCTPR.MAFePr)  , FAC.MADI1I  , FAC.MADI2I  , FAC.MADI3I , FAC.MATOTF  , FAC.MAVaAb , FAC.MAVDsc , FAC.MaVlrTIv  ,MPNUMA ,  FCTPR.PRCODI  , TRANSLATE(PROC.PRNOMB , ' ' , '",' ) ,  FCTPR.MACANPR , FCTPR.MAVLRTOT ,  FCTPR.MAVLRTOT 
UNION ALL
SELECT '860007373' AS NIT, '1' AS COD_SUCURSAL,  CASE REG.MTUDES WHEN 'CONTRIBUTIVO' THEN 'POSC'END AS REGIMEN , FAC.MPNFAC AS FACTURA , FAC.FACFCH AS FCH_FACTURA, FAC.MATOTF AS VLR_TOTAL, FAC.MAVaAb AS VLR_COPAGO , '0' AS  VLR_MODERADORA , FAC.MAVDsc AS VLR_DESCUENTOS , FAC.MaVlrTIv AS VLR_IVA, 'NO' AS MULTIUSUARIOS , PAC.MPTDOC AS TPDOCUMENTO, PAC.MPCEDU AS DOCUMENTO,  PAC.MPAPE1 AS  PRIAPELLIDO, PAC.MPAPE2 AS SEGAPELLIDO , PAC.MPNOM1 AS PRINOMBRE , PAC.MPNOM2 AS SEGNOMBRE , DATE (PAC.MPFCHN) AS FCHNACIMIENTO , PAC.MPSEXO AS GENERO , DATE (ING.INGFECADM) AS FCH_INGRESO , DATE (ING.INGFECEGR) AS FCH_EGRESO , DATE(FCTPR.MAFePr) AS FCH_PREST_SERVICIO , FAC.MADI1I AS DIAGNOSTICOS1 , FAC.MADI2I AS DIAGNOSTICOS2 , FAC.MADI3I AS DIAGNOSTICOS3, FAC.MATOTF AS VLR_TOTAL_USU , FAC.MAVaAb AS VLR_COPAGO_USU,  '0'  AS VLR_MODERADORA_USU , FAC.MAVDsc AS VLR_DESCUENTOS_USU, FAC.MaVlrTIv AS VLR_IVA_USU ,CASE  WHEN  LENGTH(REPLACE ((TRIM(TRANSLATE(FAC.MPNUMA , ' ', ' ABCDEFGHIJKLMNOPQRSTUVWXYZ@-/()#*.') )) ,' ', '') ) > 0 THEN   REPLACE ((TRIM(TRANSLATE(MPNUMA , ' ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ@*-/()#.') )) ,' ', '')  ELSE   '0' END AS NRO_AUTORIZACION ,  FCTPR.PRCODI AS COD_SERVICIO , TRANSLATE(PROC.PRNOMB , ' ' , '",' ) AS DES_SERVICIO,  FCTPR.MACANPR AS CANTIDAD , FCTPR.MPINTE AS VLR_UNITARIO_SERV,  FCTPR.MAVATP AS VLR_TOTAL_SERV , '0' AS VLR_COPAGO_SERV , '0' AS VLR_MODERADORA_SRV ,  '0' AS VLR_DESCUENTOS_SERV , '0'  AS VLR_IVA_SERV 
FROM HOSVITAL.MAEATE AS FAC
LEFT JOIN HOSVITAL.CAPBAS AS PAC ON PAC.MPCEDU = FAC.MPCEDU AND PAC.MPTDOC = FAC.MPTDOC 
LEFT JOIN HOSVITAL.INGRESOS AS ING ON ING.MPCEDU = FAC.MPCEDU AND ING.INGCSC = FAC.MACTVING AND ING.MPTDOC = FAC.MPTDOC
LEFT JOIN HOSVITAL.MAEPAC AS CNTR ON CNTR.MPCEDU= FAC.MPCEDU AND CNTR.MPTDOC = FAC.MPTDOC AND CNTR.MENNIT = FAC.MPMENI
LEFT JOIN HOSVITAL.MAETPA2 AS REG   ON CNTR.MTUCOD = REG.MTUCOD
LEFT JOIN HOSVITAL.MAEATE2 AS FCTPR ON  (FCTPR.MPNFAC = FAC.MPNFAC AND FCTPR.MAHONCOD = '' )
LEFT JOIN HOSVITAL.MAEPRO AS PROC ON PROC.PRCODI =  FCTPR.PRCODI
LEFT JOIN HOSVITAL.ADMGLO11 AS REM ON REM.MPNFAC  = FAC.MPNFAC
WHERE  FCTPR.FCPTPOTRN <> 'H' AND FCTPR.MAESANUP <> 'S' AND FAC.MPMENI IN ('NUEVAEPS', 'CS0111', 'SS0110', 'QUIRURGUICO') AND REM.AGLREMNR  BETWEEN 22754 AND  22821 
UNION ALL
SELECT '860007373' AS NIT, '1' AS COD_SUCURSAL,  CASE REG.MTUDES WHEN 'CONTRIBUTIVO' THEN 'POSC' END AS REGIMEN , FAC.MPNFAC AS FACTURA , FAC.FACFCH AS FCH_FACTURA, FAC.MATOTF AS VLR_TOTAL, FAC.MAVaAb AS VLR_COPAGO , '0' AS  VLR_MODERADORA , FAC.MAVDsc AS VLR_DESCUENTOS , FAC.MaVlrTIv AS VLR_IVA, 'NO' AS MULTIUSUARIOS , PAC.MPTDOC AS TPDOCUMENTO, PAC.MPCEDU AS DOCUMENTO,  PAC.MPAPE1 AS  PRIAPELLIDO, PAC.MPAPE2 AS SEGAPELLIDO , PAC.MPNOM1 AS PRINOMBRE , PAC.MPNOM2 AS SEGNOMBRE , DATE (PAC.MPFCHN) AS FCHNACIMIENTO , PAC.MPSEXO AS GENERO , DATE (ING.INGFECADM) AS FCH_INGRESO , DATE (ING.INGFECEGR) AS FCH_EGRESO , DATE(FCTSM.MAFCSU) AS FCH_PREST_SERVICIO , FAC.MADI1I AS DIAGNOSTICOS1 , FAC.MADI2I AS DIAGNOSTICOS2 , FAC.MADI3I AS DIAGNOSTICOS3, FAC.MATOTF AS VLR_TOTAL_USU , FAC.MAVaAb AS VLR_COPAGO_USU,  '0'  AS VLR_MODERADORA_USU , FAC.MAVDsc AS VLR_DESCUENTOS_USU, FAC.MaVlrTIv AS VLR_IVA_USU, CASE  WHEN  LENGTH(REPLACE ((TRIM(TRANSLATE(FAC.MPNUMA , ' ', ' ABCDEFGHIJKLMNOPQRSTUVWXYZ@-*/()#.') )) ,' ', '') ) > 0 THEN   REPLACE ((TRIM(TRANSLATE(MPNUMA , ' ', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ*@-/()#.') )) ,' ', '')  ELSE   '0' END AS NRO_AUTORIZACION ,
FCTSM.MSRESO AS COD_SERVICIO , TRANSLATE(MS1.MSNOMG, ' ',  '",')  AS DES_SERVICIO,  FCTSM.MACANS AS CANTIDAD , FCTSM.MAVALU AS VLR_UNITARIO_SERV,   FCTSM.MAVATS  AS VLR_TOTAL_SERV , '0' AS VLR_COPAGO_SERV , '0' AS VLR_MODERADORA_SRV ,  '0' AS VLR_DESCUENTOS_SERV , '0'  AS VLR_IVA_SERV
FROM HOSVITAL.MAEATE AS FAC
LEFT JOIN HOSVITAL.CAPBAS AS PAC ON PAC.MPCEDU = FAC.MPCEDU AND PAC.MPTDOC = FAC.MPTDOC 
LEFT JOIN HOSVITAL.INGRESOS AS ING ON ING.MPCEDU = FAC.MPCEDU AND ING.INGCSC = FAC.MACTVING AND ING.MPTDOC = FAC.MPTDOC
LEFT JOIN HOSVITAL.MAEPAC AS CNTR ON CNTR.MPCEDU= FAC.MPCEDU AND CNTR.MPTDOC = FAC.MPTDOC AND CNTR.MENNIT = FAC.MPMENI
LEFT JOIN HOSVITAL.MAETPA2 AS REG   ON CNTR.MTUCOD = REG.MTUCOD
LEFT JOIN HOSVITAL.MAEATE3 AS FCTSM ON FCTSM.MPNFAC = FAC.MPNFAC
LEFT JOIN HOSVITAL.MAESUM1 AS MS1 ON MS1.MSRESO =  FCTSM.MSRESO
LEFT JOIN HOSVITAL.ADMGLO11 AS REM ON REM.MPNFAC  = FAC.MPNFAC
WHERE FCTSM.FCSTPOTRN <> 'H' AND FCTSM.MAESANUS <> 'S' AND FAC.MPMENI IN ('NUEVAEPS', 'CS0111', 'SS0110', 'QUIRURGUICO') AND REM.AGLREMNR  BETWEEN 22777  AND 22821	

ORDER BY 4;