select * from hosvital.maesum1 where msnomg like ('%CEFEPIME%');
/*
   	
       	
       	
       	
  	
       	
       	

*/
select * from hosvital.maesum1 where msnomg like ('%CIPROFLOXACINA%');

SELECT * FROM HOSVITAL.FRMSMNS WHERE HISCKEY= '1183625' AND HISCSEC = 116 ;

 SELECT HISCKEY,HISTIPDOC,HISCSEC,FSMMSRESO,MSNOMG,FSMFHRREG,  HCSMUNDCD, HCSMCNDSP,HISCANSUM,fsmcntdia, fsmcntsol
--select *
  FROM HOSVITAL.FRMSMNS  , hosvital.maesum1 
WHERE  --hisckey= '1183625'  and hiscsec = 116  and 
 FSMMSRESO= msreso and FSMFHRREG >= '2019-03-01 00:00:00'  AND FSMMSRESO IN ('0157LB01','0003J01D','0440J01X',
'0342J01X','0001J01C','0119LB01','0001J01R','0341J01R','0158LB01','0332J01M','0335J01M','0334J01M','0333J01M','0081LB01','0304J01D','0139LB01','0001J01D','0158LB01','0341J01R',
'0001J01R','0119LB01','0001J01C','0342J01X','0440J01X','0003J01D','0157LB01','0304J01D','0139LB01','0001J01D'
);


SELECT FSMMSRESO,MSNOMG,HCSMUNDCD,SUM( HCSMCNDSP)  
FROM HOSVITAL.FRMSMNS  , HOSVITAL.MAESUM1
WHERE FSMFHRREG >= '2019-03-01 00:00:00'  AND FSMMSRESO=MSRESO AND FSMMSRESO IN ('0157LB01','0003J01D','0440J01X',
'0342J01X','0001J01C','0119LB01','0001J01R','0341J01R','0158LB01','0332J01M','0335J01M','0334J01M','0333J01M','0081LB01','0304J01D','0139LB01','0001J01D','0158LB01','0341J01R',
'0001J01R','0119LB01','0001J01C','0342J01X','0440J01X','0003J01D','0157LB01','0304J01D','0139LB01','0001J01D'
)
GROUP  BY FSMMSRESO,MSNOMG,HCSMUNDCD 
ORDER BY FSMMSRESO ;


SELECT FSMMSRESO,MSNOMG,HCSMUNDCD,SUM( HCSMCNDSP)  ,SUM( HCSMCNDSP * hiscansum)
FROM HOSVITAL.FRMSMNS  , HOSVITAL.MAESUM1
WHERE FSMFHRREG >= '2019-03-01 00:00:00'  AND FSMMSRESO=MSRESO AND FSMMSRESO IN ('0157LB01','0003J01D','0440J01X',
'0342J01X','0001J01C','0119LB01','0001J01R','0341J01R','0158LB01','0332J01M','0335J01M','0334J01M','0333J01M','0081LB01','0304J01D','0139LB01','0001J01D','0158LB01','0341J01R',
'0001J01R','0119LB01','0001J01C','0342J01X','0440J01X','0003J01D','0157LB01','0304J01D','0139LB01','0001J01D'
)
GROUP  BY FSMMSRESO,MSNOMG,HCSMUNDCD 
ORDER BY FSMMSRESO ;


/*/
-- 1183625        	CC 	116	0001J01C       	PIPERACILINA +TAZOBACTAM 4.5G POLVO PARA INYECCIÓN                                                                                                                                                                                                                  	2019-03-01 05:31:10.000000	GR	2	2.25	

*/

select *
--select msreso,  dsmcntdsp, dsmcntdes , dsmest 
 from hosvital.dspfrmc
where hisckey= '1183625' and hiscsec=116;  -- 0001J01C       	

select *
--select msreso,  dsmcntdsp, dsmcntdes , dsmest 
 from hosvital.dspfrmc
where hisckey= '40432150' and hiscsec=2255;     -- 0003J01D       	

	
 	

SELECT * FROM HOSVITAL.FRMSMNS WHERE HISCKEY = '21047210' AND HISCSEC=3338 AND  FSMMSRESO= '0341J01R ';


SELECT SUM(HISCANSUM)* FROM HOSVITAL.FRMSMNS WHERE HISCKEY = '21047210' AND HISCSEC=3338 AND  FSMMSRESO= '0341J01R ';


SELECT  * FROM HOSVITAL.FRMSMNS WHERE FSMFHRREG >= '2019-05-01 00:00:00'   AND FSMMSRESO= '0341J01R' ;     --  HISCKEY = '21047210' AND HISCSEC=3338 AND  FSMMSRESO= '0341J01R ';

SELECT   SUM( CASE WHEN HCSMUNDCD='MG' THEN   HISCANSUM/1000  WHEN HCSMUNDCD='GR' THEN   HISCANSUM   WHEN HCSMUNDCD='FC' THEN   HISCANSUM   END) 
FROM HOSVITAL.FRMSMNS 
WHERE HCFCHRDSP >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO= '0341J01R'  ; -- AND HISCKEY = '21047210';

 

SELECT  HISCKEY, HISCANSUM, HCSMUNDCD , CASE WHEN HCSMUNDCD='MG' THEN   HISCANSUM/1000 ELSE    HISCANSUM END
 FROM HOSVITAL.FRMSMNS 
WHERE HCFCHRDSP >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO= '0341J01R'  AND   HISCKEY = '21047210'; -- ; AND HCSMUNDCD='MG';


-- Primero


SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO= '0341J01R' AND HCSMUNDCD !='FC' AND  HCSMUNDCD='GR' ;

SELECT HCSMUNDCD,  COUNT(*),CAST(SUM( CASE WHEN HCSMUNDCD = 'MG' THEN   HISCANSUM/1000  WHEN HCSMUNDCD = 'GR' THEN HISCANSUM END)  AS FLOAT) AS CANTIDAD  FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO= '0341J01R'  AND HCSMUNDCD !='FC'
GROUP BY  HCSMUNDCD ;





SELECT     YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO,CAST(SUM( CASE WHEN HCSMUNDCD='MG' THEN   HISCANSUM/1000  WHEN HCSMUNDCD='GR' THEN   
CASE WHEN HISCANSUM=500.00 THEN 1 ELSE HISCANSUM END
    END)  AS FLOAT) AS CANTIDAD
FROM HOSVITAL.FRMSMNS  F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-03-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO= '0341J01R'   AND HCSMUNDCD !='FC'  AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO 
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;


-- SEGUNDO


SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO= '0304J01D ';

SELECT    YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO,CAST(SUM(   HISCANSUM   ) AS FLOAT) AS CANTIDAD
FROM HOSVITAL.FRMSMNS    F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-03-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO= '0304J01D'    AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;

--TERCERO


SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO IN ('0333J01M','0334J01M');

SELECT   YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO, CAST(SUM(   HISCANSUM   ) AS FLOAT) AS CANTIDAD
FROM HOSVITAL.FRMSMNS   F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-03-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO  IN ('0333J01M','0334J01M') AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;


-- CUARTO CIPROFLOXACINA (CLORHIDRATO) 100 MG/10 ML SOL INY                                                                                                                                                                                                                   	



SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO IN ('0332J01M');

SELECT     YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO,CAST(SUM(   CASE WHEN HCSMUNDCD='MG' THEN   HISCANSUM/1000  WHEN HCSMUNDCD='AM' THEN      HISCANSUM *100/1000  END   ) AS FLOAT)  AS CANTIDAD
FROM HOSVITAL.FRMSMNS   F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-03-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO  IN ('0332J01M') AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;


-- QUINTO


SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO IN ('0001J01D');

SELECT     YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO,CAST(SUM(   CASE WHEN HCSMUNDCD='MG' THEN   HISCANSUM/1000  WHEN HCSMUNDCD='GR' THEN      HISCANSUM   END   ) AS FLOAT)  AS CANTIDAD
FROM HOSVITAL.FRMSMNS  F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-05-03 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO  IN ('0001J01D') AND HISCANSUM!= 100.0 AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;



--

-- SEXTO


SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO IN ('0001J01C');

SELECT   YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO,CAST(SUM(   CASE WHEN HCSMUNDCD='MG' THEN   HISCANSUM  WHEN HCSMUNDCD='GR' THEN      HISCANSUM   WHEN HCSMUNDCD='FV' THEN      HISCANSUM*4.5   END   ) AS FLOAT) AS CANTIDAD 
FROM HOSVITAL.FRMSMNS  F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-03-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO  IN ('0001J01C') AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;



-- SEPTIMO


SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO IN ('0342J01X');

SELECT   YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO,CAST(SUM(   CASE WHEN HCSMUNDCD='MG' THEN   HISCANSUM/1000  WHEN HCSMUNDCD='GR' THEN      HISCANSUM   WHEN HCSMUNDCD='FC' THEN   HISCANSUM* 0.5   END   ) AS FLOAT) AS CANTIDAD
FROM HOSVITAL.FRMSMNS F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-03-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO  IN ('0342J01X') AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;


-- OCTAVO


SELECT * FROM HOSVITAL.FRMSMNS WHERE  HCFCHRDSP  >= '2019-05-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND  FSMMSRESO IN ('0003J01D');

SELECT  YEAR(HCFCHRDSP) AS AÑO, MONTH(HCFCHRDSP) AS MES, M.MPNOMP AS SERVICIO, M1.MSNOMG AS MEDICAMENTO,CAST(SUM(   CASE WHEN HCSMUNDCD='GR' THEN      HISCANSUM   WHEN HCSMUNDCD='FV' THEN   HISCANSUM* 1   END ) AS FLOAT) AS CANTIDAD
FROM HOSVITAL.FRMSMNS F , HOSVITAL.INGRESOS I, HOSVITAL.MAEPAB M, HOSVITAL.MAESUM1 M1
WHERE HCFCHRDSP >= '2019-03-01 00:00:00'  AND  HCFCHRDSP <= '2019-05-31 23:59:59'  AND FSMMSRESO  IN ('0003J01D') AND
              I.MPTDOC=F.HISTIPDOC AND I.MPCEDU=F.HISCKEY AND I.INGCSC=F.HICTVIN AND I.MPCODP=M.MPCODP and m1.msreso = F.FSMMSRESO
GROUP BY   YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP,M1.MSNOMG
ORDER BY YEAR(HCFCHRDSP), MONTH(HCFCHRDSP),M.MPNOMP;

SELECT * FROM HOSVITAL.FRMSMNS WHERE HISCKEY = '21047210' AND HISCSEC=3338 AND  FSMMSRESO= '0341J01R ';   -- HCTVIN
SELECT * FROM HOSVITAL.INGRESOS;