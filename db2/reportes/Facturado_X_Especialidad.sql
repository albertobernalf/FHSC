SELECT HOSVITAL.CAPBAS.MPCEDU AS CEDULA, HOSVITAL.CAPBAS.MPNOMC AS PACIENTE, HOSVITAL.MAEATE.MAFCHI AS FECHA_ING, HOSVITAL.MAEATE.MAFCHE AS FECHA_EGRESO, HOSVITAL.MAEATE.MACTVING AS CVO_ING, HOSVITAL.MAEATE.MPNFAC AS FACTURA, HOSVITAL.MAEATE.FACFCH AS FECHA_FACT, HOSVITAL.MAEEMP.MENOMB AS ENTIDAD, CASE HOSVITAL.MAEPRO.TPPRCD WHEN '1' THEN 'IMAG_DIAGNOSTICAS' WHEN '2' THEN 'LABORATORIOS' WHEN '3' THEN 'TERAPIAS' WHEN '4' THEN 'PRO_NO_QX' WHEN '5' THEN 'PROC._QX' WHEN '6' THEN 'OTROS' WHEN '7' THEN 'ESTANCIAS' WHEN '8' THEN 'CONSULTAS' WHEN '9' THEN 'N/A' END AS AGRUPADOR, HOSVITAL.MAEATE2.PRCODI AS SERVICIO, HOSVITAL.MAEPRO.PRNOMB AS DESC_SERVICIO, HOSVITAL.MAEATE2.MACANPR AS CANT, HOSVITAL.MAEATE2.MPINTE AS VL_UNIT, HOSVITAL.MAEATE2.MAVATP AS VL_TOTAL, HOSVITAL.MAEATE2.FCPCODSCC AS COD_CEN_COSTO, HOSVITAL.CENCOST.CNCDSC AS CENTRO_COSTO, HOSVITAL.MAEESP.MENOME AS ESPECIAIDAD, CASE HOSVITAL.MAEATE.MAESTF WHEN '0' THEN 'ACTIVA' WHEN '1' THEN 'ANULADA' WHEN '2' THEN 'RADICADA' WHEN '3' THEN 'GLOSADA' WHEN '4' THEN 'REMITIDA' WHEN '10' THEN 'ANUL_CONT' END AS ESTADO_FACT 
FROM (HOSVITAL.CENCOST INNER JOIN ((HOSVITAL.MAEPRO INNER JOIN HOSVITAL.MAEATE2 ON HOSVITAL.MAEPRO.PRCODI = HOSVITAL.MAEATE2.PRCODI)
 INNER JOIN ((HOSVITAL.CAPBAS INNER JOIN HOSVITAL.MAEATE ON (HOSVITAL.CAPBAS.MPTDOC = HOSVITAL.MAEATE.MPTDOC) AND (HOSVITAL.CAPBAS.MPCEDU = HOSVITAL.MAEATE.MPCEDU)) 
INNER JOIN HOSVITAL.MAEEMP ON HOSVITAL.MAEATE.MPMENI = HOSVITAL.MAEEMP.MENNIT) ON (HOSVITAL.MAEATE2.MATIPDOC = HOSVITAL.MAEATE.MATIPDOC) AND (HOSVITAL.MAEATE2.MPNFAC = HOSVITAL.MAEATE.MPNFAC)) ON HOSVITAL.CENCOST.CNCCOD = HOSVITAL.MAEATE2.FCPCODSCC) INNER JOIN HOSVITAL.MAEESP ON HOSVITAL.MAEATE2.MECOMM = HOSVITAL.MAEESP.MECODE WHERE HOSVITAL.MAEATE2.FCPTPOTRN<>'H' AND HOSVITAL.MAEATE2.MAESANUP<>'S' AND HOSVITAL.MAEATE.MATIPDOC=2 AND HOSVITAL.MAEATE.FACFCH>='2019-04-01' AND HOSVITAL.MAEATE.FACFCH<='2019-04-30'
 UNION 
SELECT HOSVITAL.CAPBAS.MPCEDU AS CEDULA, HOSVITAL.CAPBAS.MPNOMC AS PACIENTE, HOSVITAL.MAEATE.MAFCHI AS FECHA_ING, HOSVITAL.MAEATE.MAFCHE AS FECHA_EGRESO, HOSVITAL.MAEATE.MACTVING AS CVO_ING, HOSVITAL.MAEATE.MPNFAC AS FACTURA, HOSVITAL.MAEATE.FACFCH AS FECHA_FACT, HOSVITAL.MAEEMP.MENOMB AS ENTIDAD, CASE HOSVITAL.MAESUM1.MSGRPCOD WHEN '01' THEN 'MEDICAMENTOS' WHEN '02' THEN 'INSUMOS' WHEN '14' THEN 'ORTOPEDIA' END AS AGRUPADOR, HOSVITAL.MAEATE3.MSRESO AS SERVICIO, HOSVITAL.MAESUM1.MSNOMG AS DESC_SERVICIO, HOSVITAL.MAEATE3.MACANS AS CANT, HOSVITAL.MAEATE3.MAVALU AS VL_UNIT, HOSVITAL.MAEATE3.MAVATS AS VL_TOTAL, HOSVITAL.MAEATE3.MACENCOS AS COD_CEN_COSTO, HOSVITAL.CENCOST.CNCDSC AS CENTRO_COSTO,'' AS ESPECILIDAD, CASE HOSVITAL.MAEATE.MAESTF WHEN '0' THEN 'ACTIVA' WHEN '1' THEN 'ANULADA' WHEN '2' THEN 'RADICADA' WHEN '3' THEN 'GLOSADA' WHEN '4' THEN 'REMITIDA' WHEN '10' THEN 'ANUL_CONT' END AS ESTADO_FACT FROM ((((HOSVITAL.CAPBAS INNER JOIN HOSVITAL.MAEATE ON (HOSVITAL.CAPBAS.MPTDOC = HOSVITAL.MAEATE.MPTDOC) AND (HOSVITAL.CAPBAS.MPCEDU = HOSVITAL.MAEATE.MPCEDU)) INNER JOIN HOSVITAL.MAEEMP ON HOSVITAL.MAEATE.MPMENI = HOSVITAL.MAEEMP.MENNIT) INNER JOIN HOSVITAL.MAEATE3 ON (HOSVITAL. MAEATE.MATIPDOC = HOSVITAL.MAEATE3.MATIPDOC) AND (HOSVITAL.MAEATE.MPNFAC = HOSVITAL.MAEATE3.MPNFAC)) INNER JOIN HOSVITAL.MAESUM1 ON HOSVITAL.MAEATE3.MSRESO = HOSVITAL.MAESUM1.MSRESO) INNER JOIN HOSVITAL.CENCOST ON HOSVITAL.MAEATE3.MACENCOS = HOSVITAL.CENCOST.CNCCOD WHERE HOSVITAL.MAEATE.MATIPDOC=2 AND HOSVITAL.MAEATE3.FCSTPOTRN<>'H' AND HOSVITAL.MAEATE3.MAESPANUS<>'S' AND HOSVITAL.MAEATE.FACFCH>='2019-04-01' AND HOSVITAL.MAEATE.FACFCH<='2019-04-30'
