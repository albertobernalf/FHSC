SELECT * FROM HOSVITAL.MOVCONT3 WHERE DOCCOD='CEG' AND MVCNRO IN (32170,32169,32168,32167);
SELECT * FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CEG' AND MVCNRO=32170;
SELECT * FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CEG' AND MVCNRO=32169;

UPDATE HOSVITAL.MOVCONT3 -- ESTABA EN  NN   X   N
SET MVCCNVMON='', MVCORIGEN='', MVCESTPRE = ''
WHERE DOCCOD='CEG' AND MVCNRO=32170;

SELECT * FROM HOSVITAL.MOVBAN WHERE DOCCOD='CEG'  AND MVBNROCMP= 32170;

UPDATE  HOSVITAL.MOVCONT3 
SET  MVCEST='N'
WHERE DOCCOD='CEG' AND MVCNRO IN (32170);




UPDATE  HOSVITAL.MOVCONT2
SET  MVCVLRLC=0,  MVCVLR=0
WHERE DOCCOD='CEG' AND MVCNRO IN (32170);


SELECT * FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CNS' AND MVCNRO=958;

SELECT COUNT(*) FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CNS' AND MVCNRO=958 AND MVCCSC <= 469;

SELECT * FROM HOSVITAL.HOJOBLPRV WHERE PRVCOD='1012328498';



SELECT * FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19'  AND HOPDOCCAU !='CNS'  ;
SELECT COUNT(*)  FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19'  AND HOPDOCCAU !='CNS'  ;

SELECT COUNT(*) FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19' AND CNTVIG=2019 AND HOPDOCCAU='CNS'    ;  
SELECT * FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19' AND CNTVIG=2019 AND HOPDOCCAU='CNS'    ;  -- AND HOPNROCAU=958;  -- 488 

SELECT COUNT(*)  FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19'  AND HOPDOCCAU !='CNS'  ;

SELECT * FROM HOSVITAL.MOVCXP WHERE DOCCOD='CEG'  AND MVCXPNRO= 32170  AND  PRVCOD= '1012328498';

-- Primero

UPDATE HOSVITAL.MOVCXP
SET  MVCXPVAL=0
 WHERE EMPCOD='01' AND CNTVIG=2019 AND DOCCOD='CEG'  AND MVCXPNRO= 32170  AND  PRVCOD= '1012328498';


-- Segundo

SELECT COUNT(*) FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CNS' AND MVCNRO=958  ; -- 473 REGIDTORS
SELECT * FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CNS' AND MVCNRO=958  AND TRCCOD= '1012328498' ; -- AND MVCCSC <= 468;  -- 25050501            	





SELECT * FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19' AND CNTVIG=2019 AND PRVCOD= '1012328498' ;
UPDATE  HOSVITAL.HOJOBLPRV SET HOPTOTCRE= 1080042.00	, HOPTOTDEB  =0 WHERE HOPNOOBL='NOM.AGO19' AND CNTVIG=2019 AND PRVCOD= '1012328498' ;



-- Primero

SELECT *  FROM HOSVITAL.MOVCXP WHERE EMPCOD='01' AND CNTVIG=2019 AND DOCCOD='CEG'  AND MVCXPNRO= 32170; -- 468


UPDATE HOSVITAL.MOVCXP
SET  MVCXPVAL=0
 WHERE EMPCOD='01' AND CNTVIG=2019 AND DOCCOD='CEG'  AND MVCXPNRO= 32170  AND CNTCOD='25050501';


-- Segundo


UPDATE HOSVITAL.HOJOBLPRV H1
SET  H1.HOPTOTDEB = (SELECT  H1.HOPTOTDEB - M.MVCVLR
                                         FROM HOSVITAL.MOVCONT2 M
                                       WHERE M.DOCCOD='CNS' AND M.MVCNRO=958 AND M.CNTCOD=H1.CNTCOD AND M.TRCCOD=H1.PRVCOD AND M.MVCNAT='C')
 WHERE H1.EMPCOD='01' AND H1.HOPNOOBL = 'NOM.AGO19' AND H1.CNTVIG=2019 AND  H1.CNTCOD='25050501'; -- 471



-- LOS TRES REGISTROS

SELECT * FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CNS' AND MVCNRO=958 AND MVCNAT='C';

SELECT COUNT(*) FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CNS' AND MVCNRO=958 AND MVCNAT='C'  ;  - AND CNTCOD='25050501';

SELECT COUNT(*) FROM HOSVITAL.MOVCONT2 WHERE DOCCOD='CNS' AND MVCNRO=958 AND MVCNAT='C' AND CNTCOD='25050501';

-- Ahora va elNIF

SELECT * FROM HOSVITAL.NIMOVCON1 WHERE DOCCOD='CEG' AND NIMCNRO=32170;

UPDATE  HOSVITAL.NIMOVCON1 
SET  NIMC1EST='N'
WHERE DOCCOD='CEG' AND NIMCNRO IN (32170);


SELECT * FROM HOSVITAL.NIMOVCON2 WHERE DOCCOD='CEG' AND NIMCNRO=32170;

UPDATE  HOSVITAL.NIMOVCON2
SET  NIMC2VL=0,  NIMC2VLR=0
WHERE DOCCOD='CEG' AND NIMCNRO IN (32170);


SELECT * FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19' AND CNTVIG=2019 AND PRVCOD= '11302835' ;
UPDATE  HOSVITAL.HOJOBLPRV SET HOPTOTDEB= 1421258.00		 WHERE HOPNOOBL='NOM.AGO19' AND CNTVIG=2019 AND PRVCOD= '11302835' ;

 -- 1012328498

SELECT * FROM HOSVITAL.HOJOBLPRV  WHERE HOPNOOBL='NOM.AGO19';