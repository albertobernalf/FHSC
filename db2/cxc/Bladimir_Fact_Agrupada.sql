select * from hosvital.maeate where mpnfac = 615245;
select * from hosvital.maeate1 where mpnfac = 615245;
select * from hosvital.maeate2  where mpnfac = 615245;
select * from hosvital.maeate3 where mpnfac = 615245;


select * from hosvital.movcont3 where doccod = 'FAR' AND MVCNRO= 615245;
select * from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245;

SELECT * FROM HOSVITAL.TMPFAC WHERE TFCEDU = '900273426';
SELECT * FROM HOSVITAL.TMPFAC1 WHERE TFCEDU = '900273426';
CREATE TABLE HOSVITAL.TMPFAC1_900273426 AS (SELECT *  FROM HOSVITAL.TMPFAC1 WHERE TFCEDU = '900273426') WITH DATA;
CREATE TABLE HOSVITAL.TMPFAC_900273426 AS (SELECT *  FROM HOSVITAL.TMPFAC WHERE TFCEDU = '900273426') WITH DATA;

SELECT * FROM HOSVITAL.TMPFAC1_900273426 ;
SELECT * FROM HOSVITAL.TMPFAC_900273426 ;

DELETE FROM HOSVITAL.TMPFAC1 WHERE TFCEDU = '900273426';
DELETE FROM HOSVITAL.TMPFAC WHERE TFCEDU = '900273426';

SELECT * FROM HOSVITAL.TMPFAC2 WHERE TFCEDU = '900273426';

SELECT TFCEDU, TFPRC1,TFCANPR, TFINTE, TFVATP, TFVLRTOT,  TFCANPR* TFINTE  FROM HOSVITAL.TMPFAC1 WHERE TFCEDU = '900273426';

select * from hosvital.CAPBAS  where mPCEDU= '900273426';

select * from hosvital.movcont2 where doccod = 'FAR'  AND MVCCFCH >= '2019-12-01' AND MVCDET LIKE ('%901107%') AND MVCNRO= 615231;

SELECT  * FROM HOSVITAL.CUENTAS WHERE CNTVIG=2019 AND CNTCOD IN ('41250401','41250301');



select * from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245;




SELECT  * FROM HOSVITAL.NICUENTAS WHERE NICNTVIG=2019 AND NICNTCOD IN ('41250401','41250301');


UPDATE HOSVITAL.CUENTAS 
SET CNTOBLRF1 = 'N', CNTOBLRF2 = 'N'
WHERE CNTVIG=2019 AND CNTCOD IN ('41250401','41250301');


UPDATE HOSVITAL.NICUENTAS 
SET NICNTOR1 = 'N', NICNTOR2 = 'N'
WHERE NICNTVIG=2019 AND NICNTCOD IN ('41250401','41250301');



-- inserciones

insert INTO HOSVITAL.MOVCONT2
(EMPCOD,DOCCOD,MVCNRO,MCDPTO,MVCCSC,CNTVIG,CNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,MVCDOCRF3,MVCNAT,MVCVLRLC,MVCVLREX,MVCDET,MVCBSE,
MVCVLR,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF)
select 
EMPCOD,DOCCOD,MVCNRO,MCDPTO,2,CNTVIG,'41250401','M','M05','M0501',CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,' ' ,'C',3993600,MVCVLREX,'Procedimiento 901107',MVCBSE,
3993600,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF
from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245 AND MVCNAT='D';



insert INTO HOSVITAL.MOVCONT2
(EMPCOD,DOCCOD,MVCNRO,MCDPTO,MVCCSC,CNTVIG,CNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,MVCDOCRF3,MVCNAT,MVCVLRLC,MVCVLREX,MVCDET,MVCBSE,
MVCVLR,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF)
select 
EMPCOD,DOCCOD,MVCNRO,MCDPTO,3,CNTVIG,'41250401','M','M05','M0501',CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,' ' ,'C',3906100,MVCVLREX,'Procedimiento 901305',MVCBSE,
3906100,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF
from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245 AND MVCNAT='D';

insert INTO HOSVITAL.MOVCONT2
(EMPCOD,DOCCOD,MVCNRO,MCDPTO,MVCCSC,CNTVIG,CNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,MVCDOCRF3,MVCNAT,MVCVLRLC,MVCVLREX,MVCDET,MVCBSE,
MVCVLR,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF)
select 
EMPCOD,DOCCOD,MVCNRO,MCDPTO,4,CNTVIG,'41250401','M','M05','M0501',CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,' ' ,'C',2099200,MVCVLREX,'Procedimiento 902210',MVCBSE,
2099200,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF
from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245 AND MVCNAT='D';


insert INTO HOSVITAL.MOVCONT2
(EMPCOD,DOCCOD,MVCNRO,MCDPTO,MVCCSC,CNTVIG,CNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,MVCDOCRF3,MVCNAT,MVCVLRLC,MVCVLREX,MVCDET,MVCBSE,
MVCVLR,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF)
select 
EMPCOD,DOCCOD,MVCNRO,MCDPTO,5,CNTVIG,'41250401','M','M05','M0501',CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,' ' ,'C',4028000,MVCVLREX,'Procedimiento 903841',MVCBSE,
4028000,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF
from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245 AND MVCNAT='D';

insert INTO HOSVITAL.MOVCONT2
(EMPCOD,DOCCOD,MVCNRO,MCDPTO,MVCCSC,CNTVIG,CNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,MVCDOCRF3,MVCNAT,MVCVLRLC,MVCVLREX,MVCDET,MVCBSE,
MVCVLR,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF)
select 
EMPCOD,DOCCOD,MVCNRO,MCDPTO,6,CNTVIG,'41250401','M','M05','M0501',CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,' ' ,'C',4332600,MVCVLREX,'Procedimiento 907002',MVCBSE,
4332600,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF
from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245 AND MVCNAT='D';

insert INTO HOSVITAL.MOVCONT2
(EMPCOD,DOCCOD,MVCNRO,MCDPTO,MVCCSC,CNTVIG,CNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,MVCDOCRF3,MVCNAT,MVCVLRLC,MVCVLREX,MVCDET,MVCBSE,
MVCVLR,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF)
select 
EMPCOD,DOCCOD,MVCNRO,MCDPTO,7,CNTVIG,'41250301','M','M05','M0501',CNTSUB,TRCCOD,MVCDOCRF1,MVCDOCRF2,' ' ,'C',1510500,MVCVLREX,'Procedimiento 903818-1',MVCBSE,
1510500,MVCIMPCOD,MVCCFCH,MVCSEDORG,MVCMES,MVCANIO,MVCCMPAJ,MVCDOCRF4,MVCDOCRF5,MOVCNTPRF
from hosvital.movcont2 where doccod = 'FAR' AND MVCNRO= 615245 AND MVCNAT='D';

UPDATE  hosvital.movcont2 
SET MVCVLR= 15105000, MVCVLRLC= 15105000
where doccod = 'FAR' AND MVCNRO= 615245 AND MVCNAT='C' AND MVCCSC=7;



-- INSERT DE NIIF

SELECT * FROM HOSVITAL.NIMOVCON2 WHERE DOCCOD='FAR' AND NIMCNRO=615245;


insert INTO HOSVITAL.NIMOVCON2
(EMPCOD,DOCCOD,NIMCNRO,MCDPTO,NIMC2CSC,NICNTVIG,NICNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,NIMC2RF1,NIMC2RF2,NIMC2RF3,NIMC2NAT,NIMC2VL,NIMC2VE,NIMC2CPT,
NIMC2BSE,NIMC2VLR,NIMC2IMP,NIMC2FCH,NIMC2ANIO,NIMC2MES,NIMC2SO,NIMC2AJS,NIMC2RF4,NIMC2RF5)
select EMPCOD,DOCCOD,NIMCNRO,MCDPTO,2,NICNTVIG,'41250401','M','M05','M0501',CNTSUB,TRCCOD,NIMC2RF1,NIMC2RF2,' ','C',3993600,NIMC2VE,'Procedimiento 901107',
NIMC2BSE,3993600,NIMC2IMP,NIMC2FCH,NIMC2ANIO,NIMC2MES,NIMC2SO,NIMC2AJS,NIMC2RF4,NIMC2RF5
from hosvital.NImovcon2 where doccod = 'FAR' AND NIMCNRO= 615245 AND NIMC2NAT='D';

insert INTO HOSVITAL.NIMOVCON2
(EMPCOD,DOCCOD,NIMCNRO,MCDPTO,NIMC2CSC,NICNTVIG,NICNTCOD,CNUCOD,CNUSUB,CNCCOD,CNTSUB,TRCCOD,NIMC2RF1,NIMC2RF2,NIMC2RF3,NIMC2NAT,NIMC2VL,NIMC2VE,NIMC2CPT,
NIMC2BSE,NIMC2VLR,NIMC2IMP,NIMC2FCH,NIMC2ANIO,NIMC2MES,NIMC2SO,NIMC2AJS,NIMC2RF4,NIMC2RF5)

select EMPCOD,DOCCOD,NIMCNRO,MCDPTO,7,NICNTVIG,'41250301','M','M05','M0501',CNTSUB,TRCCOD,NIMC2RF1,NIMC2RF2,' ','C',15105000,NIMC2VE,'Procedimiento 903818-1',
NIMC2BSE,15105000,NIMC2IMP,NIMC2FCH,NIMC2ANIO,NIMC2MES,NIMC2SO,NIMC2AJS,NIMC2RF4,NIMC2RF5
from hosvital.NImovcon2 where doccod = 'FAR' AND NIMCNRO= 615245 AND NIMC2NAT='D';



-- Solucion 


SELECT * FROM HOSVITAL.TMPFAC WHERE TFCEDU = '900273426';
SELECT * FROM HOSVITAL.TMPFAC1 WHERE TFCEDU = '900273426';
SELECT * FROM HOSVITAL.TMPFAC2 WHERE TFCEDU = '900273426';
SELECT * FROM HOSVITAL.TMPFAC4 WHERE TFCEDU = '900273426';

select * from hosvital.maeate where mpnfac = 615245;
select * from hosvital.maeate1 where mpnfac = 615245;
select * from hosvital.maeate2  where mpnfac = 615245;
select * from hosvital.maeate3 where mpnfac = 615245;
SELECT * FROM HOSVITAL.TIPPROC;


SELECT * FROM HOSVITAL.MAECAUE;

/*
INSERT INTO HOSVITAL.MAEATE2 
(615245,'2',TFCSCP,TFPRC1,' ','2',' ',' ',TFFCHP,' ',2,0,MMCOM1,MECOM1,' ',TFVATP,' ',' ',' ',TFUPRO,0,'0001-01-01',
'','','','',13,0,TFCANPR,TFINTE,0,0,0,' ','001',TFPCSO,0.00,0.00,0,0,0,' ' ,1,0,'AU461',
0.0,0.0,' ' ,'N/A',0,0,'001',TFPCODSCC,
TFPTPOTRN,0,' ' ,0,'01',0.00,' ' ,TFFCHP,0,0.00,0,0,
8,' ',0,'N','N',1,' ',0,0,' ' ,0,0,' ' ,0,' ',0,0,0.00,0.00,
'','',0.00,'0001-01-01 00:00:00.000000','')
*/

INSERT INTO HOSVITAL.MAEATE2
(MPNFAC,MATIPDOC,MACSCP,PRCODI,MAHONCOD,MATIPP,MADIPR,VIACOD,MAFEPR,MADIPP,MAPROC,MAPERA,MMCODM,MECOMM,MADICO,MAVATP,MANUMAS,MACONP,MACODCON,MSUPRO,MAEPRO,
MAFPRO,MAHPRO,MPDI1S,MPDI2S,MPDI3S,MPCAUE,MPTIPD,MACANPR,MPINTE,MPOPCN,MPVIAS,MPESPE,MPNGRP,MPCODI,MPPCSO,MPPHOME,MPPINTE,MPTIPD2,MPTIPD3,MPVLRUVR,MPUVRCOD,MPTPCO,
MPTPMO,MPMHOME,MPVRPU,MPFTRV,MPFINA,MPPNDCT,MPNCITA,MPRIAD,FCPCODCCS,FCPCODSCC,FCPTPOTRN,MANUMFOL,MAUSUANL,MAAGRCIR,MAEMPCOD,MAVLRTOT,MANOMA,MAFCHREG,
MAORDLIQ,MAPORIMPT,MACANPE,MACNSAQX,MACODPAB,MACODCAM,MAESPARXTO,MAESANUP,MACORECA,MACONPR,MAINDCOP,MACODCIR,MACODPAR,MAESPANUP,MANUMAUE,MACTVENT,
MAPPPCOD,MACANCA,MAORDMAN,MAPCAUE,MACSCSAGR,MAPPORIVA,MAPVLRSIV,MAECODPQT,MATIPLIQP,MAPRODSC,MFFCHANU1,MACODANUP)
SELECT 615245,'2',TFCSCP,TFPRC1,' ','2',' ',' ','2019-12-11 00:00:00',' ',2,0,MMCOM1,MECOM1,' ',TFVATP,' ',' ',' ',TFUPRO,0,'0001-01-01',
'','','','',13,0,TFCANPR,TFINTE,0,0,0,' ','001',TFPCSO,0.00,0.00,0,0,0,' ' ,1,0,'AU461',
0.0,0.0,' ' ,'N/A',0,0,'001',TFPCODSCC,
TFPTPOTRN,0,' ' ,0,'01',0.00,' ' ,'2019-12-11',0,0.00,0,0,
8,' ',0,'N','N',1,' ',0,0,' ' ,0,0,' ' ,0,' ',0,0,0.00,0.00,
'','',0.00,'0001-01-01 00:00:00.000000',''
FROM HOSVITAL.TMPFAC1
WHERE TFCEDU = '900273426' AND TFCSCP <> 5  ;

select * from hosvital.maeate2  where mpnfac = 615245;



INSERT INTO HOSVITAL.MAEATE2
(MPNFAC,MATIPDOC,MACSCP,PRCODI,MAHONCOD,MATIPP,MADIPR,VIACOD,MAFEPR,MADIPP,MAPROC,MAPERA,MMCODM,MECOMM,MADICO,MAVATP,MANUMAS,MACONP,MACODCON,MSUPRO,MAEPRO,
MAFPRO,MAHPRO,MPDI1S,MPDI2S,MPDI3S,MPCAUE,MPTIPD,MACANPR,MPINTE,MPOPCN,MPVIAS,MPESPE,MPNGRP,MPCODI,MPPCSO,MPPHOME,MPPINTE,MPTIPD2,MPTIPD3,MPVLRUVR,MPUVRCOD,MPTPCO,
MPTPMO,MPMHOME,MPVRPU,MPFTRV,MPFINA,MPPNDCT,MPNCITA,MPRIAD,FCPCODCCS,FCPCODSCC,FCPTPOTRN,MANUMFOL,MAUSUANL,MAAGRCIR,MAEMPCOD,MAVLRTOT,MANOMA,MAFCHREG,
MAORDLIQ,MAPORIMPT,MACANPE,MACNSAQX,MACODPAB,MACODCAM,MAESPARXTO,MAESANUP,MACORECA,MACONPR,MAINDCOP,MACODCIR,MACODPAR,MAESPANUP,MANUMAUE,MACTVENT,
MAPPPCOD,MACANCA,MAORDMAN,MAPCAUE,MACSCSAGR,MAPPORIVA,MAPVLRSIV,MAECODPQT,MATIPLIQP,MAPRODSC,MFFCHANU1,MACODANUP)
SELECT 615245,'2',TFCSCP,TFPRC1,' ','2',' ',' ','2019-12-11 00:00:00',' ',2,0,MMCOM1,MECOM1,' ',TFVATP,' ',' ',' ',TFUPRO,0,'0001-01-01',
'','','','',13,0,TFCANPR,TFINTE,0,0,0,' ','001',TFPCSO,0.00,0.00,0,0,0,' ' ,1,0,'AU461',
0.0,0.0,' ' ,'N/A',0,0,'001',TFPCODSCC,
TFPTPOTRN,0,' ' ,0,'01',0.00,' ' ,'2019-12-11',0,0.00,0,0,
8,' ',0,'N','N',1,' ',0,0,' ' ,0,0,' ' ,0,' ',0,0,0.00,0.00,
'','',0.00,'0001-01-01 00:00:00.000000',''
FROM HOSVITAL.TMPFAC1
WHERE TFCEDU = '900273426' AND TFCSCP = 5  ;



SELECT * FROM HOSVITAL.ADMGLO11 WHERE MPNFAC =615245;

