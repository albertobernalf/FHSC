SELECT * FROM MOVCXP

SELECT EMPCOD,DOCCOD,MCDPTO,CNTVIG,MVCXPNUOB,PRVCOD,CNTCOD, COUNT(*)
FROM MOVCXP
WHERE MvCxPFch >= '2016-12-01' AND DOCCOD IN ('CFA','CXP')
GROUP BY EMPCOD,DOCCOD,MCDPTO,CNTVIG,MVCXPNUOB,PRVCOD,CNTCOD
HAVING COUNT(*)  >1  -- Hay (5)

-- Hay 13 Obligaciones repetidas


SELECT * FROM MOVCXP WHERE MVCXPNUOB='FV/103431'

SELECT DOCCOD,MVCNRO, SUM(MVCVLR)
FROM MOVCONT2
WHERE DOCCOD='CFA' AND MvCCFch>= '2016-12-01' AND MvCNat='C'
GROUP  BY DOCCOD,MVCNRO


SELECT DOCCOD,MVCNRO, SUM(MVCVLR)
FROM MOVCONT2
WHERE DOCCOD='CFA' AND MvCCFch>= '2016-12-01' AND MvCNat='D'
GROUP  BY DOCCOD,MVCNRO


SELECT DOCCOD,MVCNRO, MVCNAT, SUM(MVCVLR)
FROM MOVCONT2
WHERE DOCCOD='CFA' AND MvCCFch>= '2016-12-01' AND MvCNro=31833
GROUP  BY DOCCOD,MVCNRO,MVCNAT

SELECT * FROM BKP.hojoblprv_act WHERE obligacion ='-CV1-913247'

SELECT * FROM MOVCXP WHERE MvCxPNuOb = '-CV1-913247'
SELECT * FROM HOJOBLPRV WHERE HOPNOOBL = '-CV1-913247'

BEGIN TRANSACTION;
UPDATE HOJOBLPRV
SET HOPVlrObl=  71119825.00, HOPTotCre= 71119825.00
 WHERE HOPNOOBL = '-CV1-913247'
 -- COMMIT;


 SELECT * FROM HOJOBLPRV WHERE HOPNOOBL = '-CV1-913248'
 SELECT * FROM MOVCXP WHERE MvCxPNuOb = '-CV1-913248'

 BEGIN TRANSACTION;
UPDATE HOJOBLPRV
SET HOPVlrObl=  60552742.00, HOPTotCre= 60552742.00
 WHERE HOPNOOBL = '-CV1-913248'
 -- COMMIT;

 SELECT * FROM MOVCXP WHERE MvCxPNuOb = 'FV/103431'
  SELECT * FROM HOJOBLPRV WHERE HOPNOOBL = 'FV/103431'
  SELECT * FROM MOVCONT2 WHERE DOCCOD ='CFA' AND MvCNro IN ( 31647,31648     )


