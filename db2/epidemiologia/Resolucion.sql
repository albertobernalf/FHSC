SELECT HOSVITAL.CAPBAS.MPTDOC  AS TIP_DOC, HOSVITAL.CAPBAS.MPCEDU AS CEDULA, HOSVITAL.CAPBAS.MPAPE1 AS APELLIDO_1, HOSVITAL.CAPBAS.MPAPE2 AS APELLIDO_2, HOSVITAL.CAPBAS.MPNOM1 AS NOMBRE_1, HOSVITAL.CAPBAS.MPNOM2 AS NOMBRE_2, HOSVITAL.CAPBAS.MPFCHN AS FECHA_NAC, HOSVITAL.CAPBAS.MPSEXO AS SEXO, HOSVITAL.CAPBAS.MPCODETN, HOSVITAL.CAPBAS.MOCODPRI, HOSVITAL.CAPBAS.MPNIVEDU, HOSVITAL.MAEEMP.MENOMB AS EPS, HOSVITAL.INGRESOS.INGFECADM AS FECHA_ING, HOSVITAL.INGRESOS.INGUSUANU AS USUA_ANU_ING, HOSVITAL.HCCOM51.HCPRCCOD AS CUPS, HOSVITAL.MAEPRO.PRNOMB AS DESC_CUPS, HOSVITAL.HCCOM51.HCFCHRORD AS FECHA_ORDEN, HOSVITAL.HCCOM51.HCFCHRAP AS FECHA_REALIZ, HOSVITAL.HCCOM51.HCRESULT AS RESULT, HOSVITAL.HCCOM51.HCINTRES, HOSVITAL.HCCOM3DES.HCPRCCNS, HOSVITAL.HCCOM3DES.HCCONRES, HOSVITAL.HCCOM3DES.HCDESATR, HOSVITAL.HCCOM3DES.HCDSCRATR
FROM HOSVITAL.HCCOM3DES 
INNER JOIN ((((HOSVITAL.INGRESOS 
INNER JOIN HOSVITAL.CAPBAS ON (HOSVITAL.INGRESOS.MPTDOC = HOSVITAL.CAPBAS.MPTDOC) AND (HOSVITAL.INGRESOS.MPCEDU = HOSVITAL.CAPBAS.MPCEDU))
 INNER JOIN HOSVITAL.MAEEMP ON HOSVITAL.INGRESOS.INGNIT = HOSVITAL.MAEEMP.MENNIT) 
INNER JOIN HOSVITAL.HCCOM51 ON (HOSVITAL.INGRESOS.INGCSC = HOSVITAL.HCCOM51.HCTVIN51) AND (HOSVITAL.INGRESOS.MPTDOC = HOSVITAL.HCCOM51.HISTIPDOC) AND (HOSVITAL.INGRESOS.MPCEDU = HOSVITAL.HCCOM51.HISCKEY))
 INNER JOIN HOSVITAL.MAEPRO ON HOSVITAL.HCCOM51.HCPRCCOD = HOSVITAL.MAEPRO.PRCODI) ON (HOSVITAL.HCCOM3DES.HCPRCCOD = HOSVITAL.HCCOM51.HCPRCCOD) AND (HOSVITAL.HCCOM3DES.HISCSEC = HOSVITAL.HCCOM51.HISCSEC) AND (HOSVITAL.HCCOM3DES.HISTIPDOC = HOSVITAL.HCCOM51.HISTIPDOC) AND (HOSVITAL.HCCOM3DES.HISCKEY = HOSVITAL.HCCOM51.HISCKEY)
WHERE DATE(HOSVITAL.INGRESOS.INGFECADM) BETWEEN '2020-07-01' AND '2020-08-31' AND HOSVITAL.HCCOM51.HCPRCCOD IN ('901101', '90624901', '906840', '906916', '902112', '902207', '902208', '902209', '902210', '902213', '903841', '903825', '903026', '903028', '903815');


select * from hosvital.hccom51;
select * from hosvital.hccOM3DES;
select * from hosvital.hccom51 where hcfchrord >= '2020-07-01 00:00:00' and hcprccod IN ('901101', '90624901', '906840', '906916', '902112', '902207', '902208', '902209', '902210', '902213', '903841', '903825', '903026', '903028', '903815');


SELECT C.MPTDOC  AS TIP_DOC, C.MPCEDU AS CEDULA, C.MPAPE1 AS APELLIDO_1, C.MPAPE2 AS APELLIDO_2, C.MPNOM1 AS NOMBRE_1, C.MPNOM2 AS NOMBRE_2, C.MPFCHN AS FECHA_NAC, C.MPSEXO AS SEXO, C.MPCODETN, C.MOCODPRI,C.MPNIVEDU, MAE.MENOMB AS EPS, I.INGFECADM AS FECHA_ING, I.INGUSUANU AS USUA_ANU_ING, H51.HCPRCCOD AS CUPS, M.PRNOMB AS DESC_CUPS, HOSVITAL.HCCOM51.HCFCHRORD AS FECHA_ORDEN, HOSVITAL.HCCOM51.HCFCHRAP AS FECHA_REALIZ, HOSVITAL.HCCOM51.HCRESULT AS RESULT, HOSVITAL.HCCOM51.HCINTRES, HOSVITAL.HCCOM3DES.HCPRCCNS, HOSVITAL.HCCOM3DES.HCCONRES, HOSVITAL.HCCOM3DES.HCDESATR, HOSVITAL.HCCOM3DES.HCDSCRATR
FROM HOSVITAL.HCCOM3DES HDES
INNER JOIN (HOSVITAL.INGRESOS I ON (I.MPTDOC = HDES.HISTIPDOC AND I.MPCEDU = HDES.HISCKEY)
INNER JOIN HOSVITAL.CAPBAS C ON (C.MPTDOC = I.MPTDOC AND C.MPCEDU = I.MPCEDU)
 INNER JOIN HOSVITAL.MAEEMP MAE ON (MAEEMP.MENNIT = I.INGNIT ) 
INNER JOIN HOSVITAL.HCCOM51 H51 ON (    H51.HISTIPDOC = I.MPTDOC AND H51.HISCKEY = I.MPCEDU AND     H51.HCTVIN51 = I.INGCSC  AND H51.HISCSEC = HDES.HISCSEC AND H51.HCPRCCOD = HDES.HCPRCCOD )
 INNER JOIN HOSVITAL.MAEPRO M ON (M.PRCODI = H51.HCPRCCOD  )
WHERE DATE(INGRESOS.INGFECADM) BETWEEN '2020-07-01' AND '2020-08-31' AND H51.HCPRCCOD IN ('901101', '90624901', '906840', '906916', '902112', '902207', '902208', '902209', '902210', '902213', '903841', '903825', '903026', '903028', '903815');
